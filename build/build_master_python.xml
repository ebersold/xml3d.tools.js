<!-- Set based on your folder structure --> 
<property name="closure.dir" value="${basedir}/../../../closure" /> 
<!-- My folder structure within the closure folder: 
      closure/closure-compiler  (svn checkout of http://closure-compiler.googlecode.com/svn/trunk/) 
      closure/closure-library   (svn checkout of http://closure-library.googlecode.com/svn/trunk/) 
      closure/closure-templates (svn checkout of http://closure-templates.googlecode.com/svn/trunk/) --> 
<property name="closure-library.dir" value="${closure.dir}/closure-library" /> 
<property name="compiler.jar" value="${closure.dir}/closure-compiler/build/compiler.jar" /> 
<macrodef name="closure-builder"> 
    <attribute name="root" /> 
<element name="namespaces" optional="no"/> 
    <attribute name="outputfile" /> 
    <attribute name="compilationlevel" default="ADVANCED_OPTIMIZATIONS" /> 
    <element name="extraflags" optional="yes"/> 
    <sequential> 
      <exec executable="python" failonerror="true" logError="true"> 
        <arg value= 
"${closure-library.dir}/closure/bin/build/closurebuilder.py" /> 
        <arg line='--root="${closure-library.dir}"' /> 
        <arg line='--root="@{root}"' /> 
        <namespaces /> 
        <arg line='--output_mode=compiled' /> 
        <arg line='--compiler_jar=${compiler.jar}' /> 
        <arg line='--output_file=@{outputfile}' /> 
        <arg line= 
'--compiler_flags="--compilation_level=@{compilationlevel}"' /> 
        <arg line= 
'--compiler_flags="--js=${closure-library.dir}/closure/goog/deps.js"' /> 
        <arg line='--compiler_flags="--warning_level=VERBOSE"' /> 
        <extraflags /> 
      </exec> 
    </sequential> 
  </macrodef> 
<target name="my-target" description="generates myJavaScript.js"> 
<closure-builder 
      root='${basedir}/js/' 
      outputfile="${build.dir}/files/myJavaScript.js" 
       compilationlevel="ADVANCED_OPTIMIZATIONS" > 
<namespaces>         
<arg line='--namespace=mynamespace.Main' /> 
      </namespaces> 
      <extraflags> 
       <!-- Optional. This turns what would be warnings into errors for 
type safety. --> 
        <arg line='--compiler_flags="--jscomp_error=checkTypes"' /> 
      </extraflags> 
    </closure-builder> 
  </target> 